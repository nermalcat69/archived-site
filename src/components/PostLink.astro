---
import { RelativeDate } from "./RelativeDate/RelativeDate";

interface Feature {
  name: string;
  url: string;
}

interface Props {
  url: string;
  title: string;
  description?: string;
  datePublished?: Date;
  features?: Feature[];
  logo?: string;
  showImageAbove?: boolean;
}

const { url, title, description, datePublished, features, logo, showImageAbove } = Astro.props;
---

<div class="post">
  {
    datePublished && (
      <div class="date">
        <RelativeDate date={datePublished} client:load />
      </div>
    )
  }
  {showImageAbove && logo && (
    <div class="image-above">
      <img src={logo} alt={`${title} preview`} class="preview-image" />
    </div>
  )}
  <div class="title-section">
    {!showImageAbove && logo && <img src={logo} alt={`${title} logo`} class="logo" />}
    <a href={url} class="title">{title}</a>
  </div>
  <span class="description">{description}</span>
  {
    features && (
      <span class="features">
        Featured on{" "}
        {features.map(({ name, url }, i) => [
          i > 0 && ", ",
          <a href={url}>{name}</a>,
        ])}
      </span>
    )
  }
</div>

<style lang="scss">
  .post {
    display: flex;
    flex-direction: column;
    gap: var(--space-2xs);
  }

  .date,
  .features {
    color: var(--gray-11);
    font-size: var(--step--1);
  }

  .image-above {
    margin-bottom: var(--space-xs);
  }

  .preview-image {
    width: 100%;
    max-width: 300px;
    height: auto;
    border-radius: 8px;
    object-fit: cover;
  }

  .title-section {
    display: flex;
    align-items: center;
    gap: var(--space-xs);
  }

  .logo {
    width: 2rem;
    height: 2rem;
    object-fit: cover;
    border-radius: 4px;
    flex-shrink: 0;
  }

  .title {
    font-size: var(--step-1);
    line-height: 1.3;
    align-self: flex-start;
  }
</style>
